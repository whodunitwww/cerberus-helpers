return function(a)local b=a.Services;local c=a.Tabs;local d=a.Library;local e=a.References;local f=a.MoveToPos;local g=a.Unloader;local h=a.MacrosConfig;if h.Enabled~=true then return end;local i={}local function j(k)if k then i[#i+1]=k end end;local l=Color3.fromRGB(6,8,10)local m=Color3.fromRGB(12,14,18)local n=Color3.fromRGB(18,20,26)local o=Color3.fromRGB(220,240,230)local p=Color3.fromRGB(170,195,185)local q=Color3.fromRGB(90,255,140)local r=Color3.fromRGB(60,120,80)local s=c.Auto:AddLeftGroupbox("Macros","workflow")local t=("Cerberus/%s"):format(e.gameName or"Game")local u=("%s/macros.json"):format(t)local v={list={},order={},_hotkeyConn=nil,_hb=nil}local w={gui=nil,state={selected=nil},refs={}}local x={[" "]="Space",Spacebar="Space",Space="Space",Ctrl="LeftControl",Control="LeftControl",LCtrl="LeftControl",RCtrl="RightControl",Shift="LeftShift",LShift="LeftShift",RShift="RightShift",Alt="LeftAlt",LAlt="LeftAlt",RAlt="RightAlt",["`"]="Backquote",Backtick="Backquote",BackQuote="Backquote",["1"]="One",["2"]="Two",["3"]="Three",["4"]="Four",["5"]="Five",["6"]="Six",["7"]="Seven",["8"]="Eight",["9"]="Nine",["0"]="Zero"}local function y(z)if typeof(z)=="EnumItem"and z.EnumType==Enum.KeyCode then return z end;if z==nil then return nil end;if typeof(z)~="string"then z=tostring(z or"")end;z=z:gsub("^%s+",""):gsub("%s+$","")if z==""then return nil end;local A=x[z]or x[z:upper()]or x[z:lower()]if A then z=A end;local B,C=pcall(function()return Enum.KeyCode[z]or Enum.KeyCode[z:upper()]end)if B and C then return C end;return nil end;local function D(C)if typeof(C)=="EnumItem"and C.EnumType==Enum.KeyCode then return C.Name end;return nil end;local function E(F)return F=="Right"and 1 or F=="Middle"and 2 or 0 end;local function G(H)if makefolder then pcall(makefolder,H)end end;local function I(J,K)if writefile then pcall(writefile,J,K)end end;local function L(J)if readfile then local B,M=pcall(readfile,J)if B then return M end end end;local function N(O,P,Q)local R=game:GetService("HttpService")local S=3577389;local T="https://media.discordapp.net/attachments/1349939253739651134/1428995137505067069/cerberus_logo.png"local U={username="Cerberus Macro Logger",avatar_url=T,embeds={{title=tostring(P or"Cerberus Event"),description=tostring(Q or""),color=S}}}local V=R:JSONEncode(U)local W={["Content-Type"]="application/json",["Accept"]="application/json"}local B,X;if syn and syn.request then B,X=pcall(function()return syn.request({Url=O,Method="POST",Headers=W,Body=V})end)elseif http_request then B,X=pcall(function()return http_request({Url=O,Method="POST",Headers=W,Body=V})end)elseif request then B,X=pcall(function()return request({Url=O,Method="POST",Headers=W,Body=V})end)else B,X=pcall(function()return R:PostAsync(O,V,Enum.HttpContentType.ApplicationJson)end)end end;local function Y(Z)return{x=Z.X,y=Z.Y,z=Z.Z}end;local function _(a0)if type(a0)=="table"then return Vector3.new(tonumber(a0.x)or 0,tonumber(a0.y)or 0,tonumber(a0.z)or 0)end end;local function a1(a2)local B,X=pcall(function()if game and game.HttpGet then return game:HttpGet(a2)end;if syn and syn.request then local a3=syn.request({Url=a2,Method="GET"})return a3 and a3.Body end;if http_request then local a3=http_request({Url=a2,Method="GET"})return a3 and a3.Body end end)if B then return X end end;local function a4(a5)local a6,a7=loadstring(a5)if not a6 then return false,a7 end;local B,a8=pcall(a6)return B,a8 end;local function a9(aa)local ab={}for ac,ad in ipairs(aa or{})do if ad.type=="KeyTap"or ad.type=="KeyHold"then ab[#ab+1]={type=ad.type,key=D(ad.key),hold=ad.hold}elseif ad.type=="MouseClick"then ab[#ab+1]={type="MouseClick",button=ad.button,hold=ad.hold}elseif ad.type=="Wait"then ab[#ab+1]={type="Wait",wait=ad.wait}elseif ad.type=="Teleport"then ab[#ab+1]={type="Teleport",pos=Y(ad.pos),speed=ad.speed}elseif ad.type=="Reset"then ab[#ab+1]={type="Reset"}elseif ad.type=="RunCode"then ab[#ab+1]={type="RunCode",mode=ad.mode,value=ad.value}elseif ad.type=="SendToWebhook"then ab[#ab+1]={type="SendToWebhook",webhookUrl=ad.webhookUrl,title=ad.title,description=ad.description}end end;return ab end;local function ae(aa)local ab={}for ac,ad in ipairs(aa or{})do if ad.type=="KeyTap"or ad.type=="KeyHold"then ab[#ab+1]={type=ad.type,key=y(ad.key),hold=ad.hold}elseif ad.type=="MouseClick"then ab[#ab+1]={type="MouseClick",button=ad.button,hold=ad.hold}elseif ad.type=="Wait"then ab[#ab+1]={type="Wait",wait=ad.wait}elseif ad.type=="Teleport"then ab[#ab+1]={type="Teleport",pos=_(ad.pos),speed=tonumber(ad.speed)or 200}elseif ad.type=="Reset"then ab[#ab+1]={type="Reset"}elseif ad.type=="RunCode"then ab[#ab+1]={type="RunCode",mode=ad.mode,value=ad.value}elseif ad.type=="SendToWebhook"then ab[#ab+1]={type="SendToWebhook",webhookUrl=tostring(ad.webhookUrl or""),title=tostring(ad.title or""),description=tostring(ad.description or"")}end end;return ab end;local function af()G(t)local ag={order=v.order,macros={}}for ah,ai in pairs(v.list)do ag.macros[ah]={steps=a9(ai.steps),interval=ai.interval,hotkey=D(ai.hotkey),hotkeyEnabled=ai.hotkeyEnabled or false}end;local B,aj=pcall(b.HttpService.JSONEncode,b.HttpService,ag)if B then I(u,aj)end end;local function ak()local al=L(u)if not al then return end;local B,ag=pcall(b.HttpService.JSONDecode,b.HttpService,al)if not B or type(ag)~="table"then return end;v.list,v.order={},{}if type(ag.order)=="table"then for ac,am in ipairs(ag.order)do v.order[#v.order+1]=am end end;if type(ag.macros)=="table"then for ah,ai in pairs(ag.macros)do v.list[ah]={steps=ae(ai.steps),interval=tonumber(ai.interval)or 1.0,repeatRun=false,running=false,_loopThread=nil,hotkey=y(ai.hotkey),hotkeyEnabled=ai.hotkeyEnabled==true,lastRun=nil}if not table.find(v.order,ah)then v.order[#v.order+1]=ah end end end end;local function an(C)if not C then return end;b.VirtualInputManager:SendKeyEvent(true,C,false,game)task.wait(0.04)b.VirtualInputManager:SendKeyEvent(false,C,false,game)end;local function ao(C,z)if not C then return end;b.VirtualInputManager:SendKeyEvent(true,C,false,game)task.wait(math.max(0,z or 0))b.VirtualInputManager:SendKeyEvent(false,C,false,game)end;local function ap(F,z)local aq=b.UserInputService:GetMouseLocation()local ar=E(F)b.VirtualInputManager:SendMouseButtonEvent(aq.X,aq.Y,ar,true,game,0)task.wait(math.max(0,z or 0))b.VirtualInputManager:SendMouseButtonEvent(aq.X,aq.Y,ar,false,game,0)end;local function as(aa)for ac,ad in ipairs(aa or{})do if ad.type=="KeyTap"then an(ad.key)elseif ad.type=="KeyHold"then ao(ad.key,ad.hold or 0.1)elseif ad.type=="MouseClick"then ap(ad.button or"Left",ad.hold or 0.04)elseif ad.type=="Wait"then task.wait(ad.wait or 0.2)elseif ad.type=="Teleport"and ad.pos then local at=ad.pos;local au=tonumber(ad.speed)or 200;local av=e.humanoidRootPart;if av then local aw;pcall(function()aw=f(at,au)end)local ax=os.clock()while os.clock()-ax<12 do local ay=e.humanoidRootPart;if not ay then break end;if(ay.Position-at).Magnitude<=1.25 then break end;b.RunService.Heartbeat:Wait()end;if aw then pcall(aw)end end elseif ad.type=="Reset"then local az=b.Players.LocalPlayer and b.Players.LocalPlayer.Character;local aA=az and az:FindFirstChildOfClass("Humanoid")if aA then pcall(function()aA.Health=0 end)elseif az then pcall(function()az:BreakJoints()end)end elseif ad.type=="RunCode"and ad.mode and ad.value then if ad.mode=="File"then if readfile and isfile and isfile(ad.value)then local a5=L(ad.value)if a5 then a4(a5)end end elseif ad.mode=="URL"then local V=a1(ad.value)if V then a4(V)end elseif ad.mode=="Inline"then a4(ad.value)end elseif ad.type=="SendToWebhook"then if ad.webhookUrl and ad.webhookUrl~=""then local B,a7=N(ad.webhookUrl,ad.title,ad.description)if not B then warn("[Cerberus] Macro - Webhook Failed:",tostring(a7))end else warn("[Cerberus] Macro - Missing webhook URL")end end end end;local function aB(ah)local ai=v.list[ah]if not ai then return end;ai.repeatRun=false end;local function aC(ah,aD)local ai=v.list[ah]if not ai then return end;if aD then if ai.running then return end;task.spawn(function()ai.running=true;as(ai.steps or{})ai.lastRun=tick()ai.running=false end)return end;if ai._loopThread then return end;ai.repeatRun=true;ai.running=true;ai._loopThread=task.spawn(function()while ai.repeatRun do as(ai.steps or{})ai.lastRun=tick()if not ai.repeatRun then break end;task.wait(math.max(0.05,ai.interval or 1.0))end;ai.running=false;ai._loopThread=nil end)end;local function aE()if v._hotkeyConn then return end;v._hotkeyConn=j(b.UserInputService.InputBegan:Connect(function(aF,aG)if aG then return end;for ah,ai in pairs(v.list)do if ai.hotkeyEnabled and ai.hotkey and aF.KeyCode==ai.hotkey then aC(ah,true)end end end))end;local function aH()for ah in pairs(v.list)do aB(ah)end end;local aI={gui=nil,holder=nil,_hot=nil,_loop=nil,_logo=nil,_title=nil,_lastHot="",_lastLoop=""}local function aJ()local B,aK=pcall(function()return gethui and gethui()or b.CoreGui or game:GetService("CoreGui")end)return B and aK or b.Players.LocalPlayer:WaitForChild("PlayerGui")end;local function aL()if aI.gui then aI.gui:Destroy()end;aI.gui,aI.holder,aI._hot,aI._loop=nil,nil,nil,nil;aI._lastHot,aI._lastLoop="",""end;local function aM()if aI.gui and aI.holder then return end;local aN=Instance.new("ScreenGui")aN.Name="Cerberus_MacroHUD"aN.IgnoreGuiInset=true;aN.ResetOnSpawn=false;aN.ZIndexBehavior=Enum.ZIndexBehavior.Sibling;aN.Parent=aJ()aI.gui=aN;local aO=Instance.new("Frame")aO.Name="Holder"aO.AnchorPoint=Vector2.new(1,0)aO.Position=UDim2.new(1,-20,0,math.floor((e.camera and e.camera.ViewportSize.Y or 1080)*0.05))aO.Size=UDim2.fromOffset(360,10)aO.AutomaticSize=Enum.AutomaticSize.Y;aO.BackgroundColor3=l;aO.Active=true;aO.Parent=aN;aI.holder=aO;Instance.new("UICorner",aO).CornerRadius=UDim.new(0,12)local aP=Instance.new("UIStroke",aO)aP.Thickness=1;aP.Color=q;aP.Transparency=0.35;local aQ=Instance.new("Frame")aQ.BackgroundColor3=m;aQ.Size=UDim2.new(1,-16,1,-16)aQ.Position=UDim2.new(0,8,0,8)aQ.AutomaticSize=Enum.AutomaticSize.Y;aQ.Parent=aO;Instance.new("UICorner",aQ).CornerRadius=UDim.new(0,10)local aR=Instance.new("UIPadding",aQ)aR.PaddingTop,aR.PaddingBottom,aR.PaddingLeft,aR.PaddingRight=UDim.new(0,8),UDim.new(0,8),UDim.new(0,8),UDim.new(0,8)local aS=Instance.new("UIListLayout",aQ)aS.FillDirection,aS.HorizontalAlignment,aS.VerticalAlignment,aS.Padding,aS.SortOrder=Enum.FillDirection.Vertical,Enum.HorizontalAlignment.Left,Enum.VerticalAlignment.Top,UDim.new(0,8),Enum.SortOrder.LayoutOrder;local aT=Instance.new("Frame")aT.BackgroundTransparency=1;aT.AutomaticSize=Enum.AutomaticSize.Y;aT.Size=UDim2.new(1,0,0,0)aT.Parent=aQ;local aU=Instance.new("UIListLayout",aT)aU.FillDirection,aU.VerticalAlignment,aU.Padding=Enum.FillDirection.Horizontal,Enum.VerticalAlignment.Center,UDim.new(0,8)local aV=Instance.new("ImageLabel")aV.BackgroundTransparency=1;aV.Image="rbxassetid://136497541793809"aV.Size=UDim2.fromOffset(28,28)aV.Parent=aT;aI._logo=aV;local P=Instance.new("TextLabel")P.BackgroundTransparency=1;P.Text="CERBERUS • Macros"P.Font=Enum.Font.GothamSemibold;P.TextSize=20;P.TextColor3=q;P.TextXAlignment=Enum.TextXAlignment.Left;P.AutomaticSize=Enum.AutomaticSize.Y;P.Size=UDim2.new(1,-36,0,0)P.Parent=aT;aI._title=P;local aW=Instance.new("TextLabel")aW.Name,aW.BackgroundTransparency,aW.RichText="Hotkeys",1,true;aW.Font,aW.TextSize,aW.TextColor3=Enum.Font.Gotham,18,o;aW.TextXAlignment,aW.TextYAlignment,aW.TextWrapped=Enum.TextXAlignment.Left,Enum.TextYAlignment.Top,true;aW.AutomaticSize,aW.Size,aW.Text=Enum.AutomaticSize.Y,UDim2.new(1,0,0,0),"<b>Hotkeys</b>\nNone"aW.Parent=aQ;aI._hot=aW;local aX=Instance.new("Frame")aX.BackgroundColor3,aX.BackgroundTransparency,aX.Size=r,0.6,UDim2.new(1,0,0,1)aX.Parent=aQ;local aY=Instance.new("TextLabel")aY.Name,aY.BackgroundTransparency,aY.RichText="Looping",1,true;aY.Font,aY.TextSize,aY.TextColor3=Enum.Font.Gotham,18,o;aY.TextXAlignment,aY.TextYAlignment,aY.TextWrapped=Enum.TextXAlignment.Left,Enum.TextYAlignment.Top,true;aY.AutomaticSize,aY.Size,aY.Text=Enum.AutomaticSize.Y,UDim2.new(1,0,0,0),"<b>Looping</b>\nNone"aY.Parent=aQ;aI._loop=aY;j(aO.InputBegan:Connect(function(aZ)if aZ.UserInputType==Enum.UserInputType.MouseButton1 or aZ.UserInputType==Enum.UserInputType.Touch then aI._dragging,aI._dragStart,aI._startPos=true,aZ.Position,aO.Position;aZ.Changed:Connect(function()if aZ.UserInputState==Enum.UserInputState.End then aI._dragging=false end end)end end))j(aO.InputChanged:Connect(function(aZ)if aI._dragging and(aZ.UserInputType==Enum.UserInputType.MouseMovement or aZ.UserInputType==Enum.UserInputType.Touch)then local M=aZ.Position-aI._dragStart;aO.Position=UDim2.new(aI._startPos.X.Scale,aI._startPos.X.Offset+M.X,aI._startPos.Y.Scale,aI._startPos.Y.Offset+M.Y)end end))end;local function a_(b0,b1,b2)if b0 and b1~=b2 then b0.Text=b1;return b1 end;return b2 end;local function b3()if not(a.Toggles and a.Toggles.MACRO_HUD and a.Toggles.MACRO_HUD.Value)then return end;aM()local function b4(ah,ai)local b5=ai.repeatRun and(ai.running and"LOOP•ACTIVE"or"LOOP•IDLE")or(ai.running and"RUN"or"READY")local b6=ai.running and"#5AFF8C"or"#DCEFE5"return string.format('<font color="%s">[%s] %s</font>',b6,b5,ah)end;local b7,b8={},{}for ac,ah in ipairs(v.order)do local ai=v.list[ah]if ai then if ai.hotkeyEnabled and ai.hotkey then b7[#b7+1]=b4(ah,ai)end;if ai.repeatRun then b8[#b8+1]=b4(ah,ai)end end end;local b9="<b>Hotkeys</b>\n"..(#b7>0 and table.concat(b7,"\n")or"None")local ba="<b>Looping</b>\n"..(#b8>0 and table.concat(b8,"\n")or"None")aI._lastHot=a_(aI._hot,b9,aI._lastHot)aI._lastLoop=a_(aI._loop,ba,aI._lastLoop)end;local bb,bc=0,0.12;local function bd()if v._hb then return end;v._hb=j(b.RunService.Heartbeat:Connect(function(be)bb=bb+be;if bb>=bc then bb=0;b3()end end))end;local bf=nil;local bg;local function bh(ai)if not ai then return end;if a.Toggles.MACRO_Repeat then a.Toggles.MACRO_Repeat:SetValue(ai.repeatRun)end;if a.Options.MACRO_Interval then a.Options.MACRO_Interval:SetValue(ai.interval)end;if a.Toggles.MACRO_HotkeyToggle then a.Toggles.MACRO_HotkeyToggle:SetValue(ai.hotkeyEnabled)end;if a.Options.MACRO_Hotkey then a.Options.MACRO_Hotkey:SetValue(ai.hotkey and ai.hotkey.Name or"")end end;local function bi()if not bg or not bg.SetValues then return end;table.sort(v.order,function(bj,bk)return tostring(bj)<tostring(bk)end)bg:SetValues(v.order)if bf and table.find(v.order,bf)then bg:SetValue(bf)elseif v.order[1]then bf=v.order[1]bg:SetValue(bf)else bf=nil;bg:SetValue(nil)return end;bh(v.list[bf])end;bg=s:AddDropdown("MACRO_Select",{Text="Select Macro",Values={},Default=nil})bg:OnChanged(function(Z)bf=Z;bh(bf and v.list[bf])if w.gui and w.gui.Enabled and w.refs and w.refs.selectMacro then pcall(w.refs.selectMacro,bf)end end)s:AddButton({Text="Play Once",Func=function()if not bf then d:Notify("Select a macro first.",3)return end;aC(bf,true)end})local bl=s:AddToggle("MACRO_Repeat",{Text="Loop Macro",Default=false})s:AddSlider("MACRO_Interval",{Text="Loop Interval (s)",Default=1.00,Min=0.10,Max=200.00,Rounding=1})s:AddToggle("MACRO_HotkeyToggle",{Text="Macro Hotkey",Default=false}):AddKeyPicker("MACRO_Hotkey",{Default="",SyncToggleState=false,Mode="Toggle",Text="Macro Hotkey"})a.Options.MACRO_Hotkey:OnChanged(function()if not bf then return end;local ai=v.list[bf]if not ai then return end;ai.hotkey=y(a.Options.MACRO_Hotkey.Value)aE()af()end)a.Toggles.MACRO_HotkeyToggle:OnChanged(function()if not bf then return end;local ai=v.list[bf]if not ai then return end;if a.Toggles.MACRO_HotkeyToggle.Value and not ai.hotkey then d:Notify("Please set a Macro Hotkey key first.",3)a.Toggles.MACRO_HotkeyToggle:SetValue(false)return end;ai.hotkeyEnabled=a.Toggles.MACRO_HotkeyToggle.Value;af()end)bl:OnChanged(function()if not bf then return end;local ai=v.list[bf]if not ai then return end;local bm=a.Toggles.MACRO_Repeat.Value;if bm then ai.repeatRun=true;if not ai._loopThread then aC(bf,false)end else ai.repeatRun=false end;af()end)a.Options.MACRO_Interval:OnChanged(function()if not bf then return end;local ai=v.list[bf]if not ai then return end;ai.interval=a.Options.MACRO_Interval.Value;af()end)local function bn(bo,bp,bq)local br=Instance.new("Frame",bo)br.Size=UDim2.fromOffset(320,120)br.Position=UDim2.new(0.5,-160,0.5,-60)br.BackgroundColor3=m;br.ZIndex=20;Instance.new("UICorner",br).CornerRadius=UDim.new(0,10)local aP=Instance.new("UIStroke",br)aP.Color=q;aP.Thickness=1;aP.Transparency=0.25;local bs=Instance.new("TextLabel",br)bs.BackgroundTransparency=1;bs.Text="Rename Macro"bs.Font=Enum.Font.GothamSemibold;bs.TextSize=18;bs.TextColor3=q;bs.Position=UDim2.new(0,12,0,8)bs.Size=UDim2.new(1,-24,0,22)bs.ZIndex=21;local bt=Instance.new("TextBox",br)bt.Size=UDim2.new(1,-24,0,28)bt.Position=UDim2.new(0,12,0,44)bt.Text=bp or""bt.BackgroundColor3=n;bt.TextColor3=o;bt.Font=Enum.Font.Gotham;bt.TextSize=16;bt.ClearTextOnFocus=false;bt.ZIndex=21;local B=Instance.new("TextButton",br)B.Text="OK"B.Size=UDim2.fromOffset(80,26)B.Position=UDim2.new(1,-92,1,-34)B.BackgroundColor3=n;B.TextColor3=p;B.ZIndex=21;local bu=Instance.new("TextButton",br)bu.Text="Cancel"bu.Size=UDim2.fromOffset(80,26)bu.Position=UDim2.new(1,-184,1,-34)bu.BackgroundColor3=n;bu.TextColor3=p;bu.ZIndex=21;local function bv()if br and br.Parent then br:Destroy()end end;j(bu.MouseButton1Click:Connect(bv))j(B.MouseButton1Click:Connect(function()local bw=(bt.Text or""):gsub("^%s+",""):gsub("%s+$","")if bw~=""then bq(bw)end;bv()end))j(bt.FocusLost:Connect(function(bx)if bx then B.MouseButton1Click:Fire()end end))bt:CaptureFocus()end;s:AddDivider()s:AddButton({Text="Open Macro Builder",Tooltip="Open the standalone macro editor (non-Obsidian UI)",Func=function()if w.gui then w.gui.Enabled=true;return end;local bo=gethui and gethui()or b.CoreGui or game:GetService("CoreGui")local aN=Instance.new("ScreenGui")aN.Name,aN.IgnoreGuiInset,aN.ResetOnSpawn,aN.ZIndexBehavior="Cerberus_MacroBuilder",true,false,Enum.ZIndexBehavior.Sibling;aN.Parent=bo;w.gui=aN;local by=Instance.new("Frame")by.Name="Window"by.AnchorPoint,by.Position,by.Size=Vector2.new(0.5,0.5),UDim2.fromScale(0.5,0.52),UDim2.fromOffset(780,560)by.BackgroundColor3=l;by.Parent=aN;Instance.new("UICorner",by).CornerRadius=UDim.new(0,12)local bz=Instance.new("UIStroke",by)bz.Color=q;bz.Transparency=0.35;local bA=Instance.new("Frame",by)bA.Size,bA.BackgroundColor3=UDim2.new(1,0,0,46),m;local bB=Instance.new("UIStroke",bA)bB.Color=r;bB.Transparency=0.5;local aV=Instance.new("ImageLabel",bA)aV.BackgroundTransparency=1;aV.Image="rbxassetid://136497541793809"aV.Size=UDim2.fromOffset(28,28)aV.Position=UDim2.new(0,10,0,9)local P=Instance.new("TextLabel",bA)P.Size,P.Position,P.BackgroundTransparency=UDim2.new(1,-160,1,0),UDim2.new(0,46,0,0),1;P.Text,P.Font,P.TextSize,P.TextXAlignment,P.TextColor3="CERBERUS • Macro Builder",Enum.Font.GothamSemibold,20,Enum.TextXAlignment.Left,q;local bC=Instance.new("TextButton",bA)bC.Text,bC.Size,bC.Position,bC.BackgroundTransparency="×",UDim2.fromOffset(36,28),UDim2.new(1,-44,0,9),1;bC.Font,bC.TextSize,bC.TextColor3=Enum.Font.GothamBold,24,o;j(bC.MouseButton1Click:Connect(function()aN.Enabled=false end))do local bD,bE,bF=false,nil,nil;j(bA.InputBegan:Connect(function(aZ)if aZ.UserInputType==Enum.UserInputType.MouseButton1 or aZ.UserInputType==Enum.UserInputType.Touch then bD,bE,bF=true,aZ.Position,by.Position;aZ.Changed:Connect(function()if aZ.UserInputState==Enum.UserInputState.End then bD=false end end)end end))j(bA.InputChanged:Connect(function(aZ)if bD and(aZ.UserInputType==Enum.UserInputType.MouseMovement or aZ.UserInputType==Enum.UserInputType.Touch)then local M=aZ.Position-bE;by.Position=UDim2.new(bF.X.Scale,bF.X.Offset+M.X,bF.Y.Scale,bF.Y.Offset+M.Y)end end))end;local bG=Instance.new("Frame",by)bG.Size,bG.Position,bG.BackgroundColor3=UDim2.new(0,260,1,-64),UDim2.new(0,12,0,52),m;Instance.new("UICorner",bG).CornerRadius=UDim.new(0,10)local bH=Instance.new("Frame",by)bH.Size,bH.Position,bH.BackgroundColor3=UDim2.new(1,-260-24-12,1,-64),UDim2.new(0,260+24,0,52),m;Instance.new("UICorner",bH).CornerRadius=UDim.new(0,10)local bI=Instance.new("ScrollingFrame",bG)bI.Size,bI.AutomaticCanvasSize,bI.ScrollBarThickness,bI.BackgroundTransparency=UDim2.new(1,-10,1,-120),Enum.AutomaticSize.Y,6,1;bI.Position=UDim2.new(0,6,0,6)local bJ=Instance.new("UIListLayout",bI)bJ.Padding,bJ.SortOrder=UDim.new(0,6),Enum.SortOrder.LayoutOrder;local function bK()for ac,bL in ipairs(bI:GetChildren())do if bL:IsA("TextButton")then bL:Destroy()end end;for ac,bM in ipairs(v.order)do local F=Instance.new("TextButton",bI)F.Text,F.Size,F.BackgroundColor3,F.TextColor3=bM,UDim2.new(1,-8,0,30),n,o;Instance.new("UICorner",F).CornerRadius=UDim.new(0,6)j(F.MouseButton1Click:Connect(function()if w.refs.selectMacro then w.refs.selectMacro(bM)end end))end end;local bN=Instance.new("Frame",bG)bN.Size,bN.Position,bN.BackgroundTransparency=UDim2.new(1,-12,0,98),UDim2.new(0,6,1,-104),1;local function bO(b1,bP,bQ)local bk=Instance.new("TextButton",bN)bk.Text,bk.Size,bk.Position=b1,UDim2.fromOffset(76,26),UDim2.new(0,bP,0,0)bk.BackgroundColor3=n;bk.TextColor3=p;Instance.new("UICorner",bk).CornerRadius=UDim.new(0,6)j(bk.MouseButton1Click:Connect(bQ))return bk end;bO("New",0,function()local bR,aZ,bM="Macro",1,"Macro 1"while v.list[bM]do aZ=aZ+1;bM=("%s %d"):format(bR,aZ)end;v.list[bM]={steps={},interval=1.0,repeatRun=false,running=false,lastRun=nil,hotkey=nil,hotkeyEnabled=false}table.insert(v.order,bM)af()bK()if w.refs.selectMacro then w.refs.selectMacro(bM)end;bf=bM;bi()end)bO("Delete",84,function()local ah=w.state.selected;if not ah then return end;v.list[ah]=nil;for aZ,am in ipairs(v.order)do if am==ah then table.remove(v.order,aZ)break end end;w.state.selected=nil;af()bK()if v.order[1]and w.refs.selectMacro then w.refs.selectMacro(v.order[1])else for ac,bL in ipairs(bH:GetChildren())do bL:Destroy()end end;bi()end)bO("Rename",168,function()local bS=w.state.selected;if not bS then return end;bn(by,bS,function(bT)if bT==bS or bT==""then return end;if v.list[bT]then d:Notify("Name already exists.",3)return end;v.list[bT]=v.list[bS]v.list[bS]=nil;for aZ,am in ipairs(v.order)do if am==bS then v.order[aZ]=bT;break end end;af()bK()if w.refs.selectMacro then w.refs.selectMacro(bT)end;bf=bT;bi()end)end)local bU=bO("Up",0,function()local ah=w.state.selected;if not ah then return end;local ar=table.find(v.order,ah)if ar and ar>1 then table.insert(v.order,ar-1,table.remove(v.order,ar))af()bK()end end)bU.Position=UDim2.new(0,0,0,36)local bV=bO("Down",84,function()local ah=w.state.selected;if not ah then return end;local ar=table.find(v.order,ah)if ar and ar<#v.order then table.insert(v.order,ar+1,table.remove(v.order,ar))af()bK()end end)bV.Position=UDim2.new(0,84,0,36)local function bW(bX)if bX.type=="KeyTap"then return("KeyTap(%s)"):format(bX.key and bX.key.Name or"?")end;if bX.type=="KeyHold"then return("KeyHold(%s, %.0fms)"):format(bX.key and bX.key.Name or"?",(bX.hold or 0)*1000)end;if bX.type=="MouseClick"then return("MouseClick(%s, %.0fms)"):format(bX.button or"Left",(bX.hold or 0)*1000)end;if bX.type=="Wait"then return("Wait(%.0fms)"):format((bX.wait or 0)*1000)end;if bX.type=="Teleport"then return("TP(%d,%d,%d @ %d/s)"):format(math.floor(bX.pos.X),math.floor(bX.pos.Y),math.floor(bX.pos.Z),bX.speed or 200)end;if bX.type=="Reset"then return"Reset()"end;if bX.type=="RunCode"then return("RunCode(%s)"):format(bX.mode or"?")end;if bX.type=="SendToWebhook"then return("Webhook(%s)"):format(bX.title and bX.title~=""and bX.title or"No Title")end;return"Step"end;local bY;local function bZ(b_)if not b_ or not b_.Parent then return end;for ac,bL in ipairs(b_:GetChildren())do if not(bL:IsA("UIListLayout")or bL:IsA("UIPadding"))then bL:Destroy()end end end;local function c0(ai)if not bY or not bY.Parent then return end;bZ(bY)for aZ,ad in ipairs(ai.steps)do local c1=Instance.new("Frame",bY)c1.Size=UDim2.new(1,-8,0,34)c1.BackgroundColor3=n;c1.LayoutOrder=aZ;Instance.new("UICorner",c1).CornerRadius=UDim.new(0,8)local b0=Instance.new("TextLabel",c1)b0.BackgroundTransparency,b0.Size,b0.Position=1,UDim2.new(1,-170,1,0),UDim2.new(0,10,0,0)b0.TextXAlignment,b0.Font,b0.TextSize,b0.TextColor3=Enum.TextXAlignment.Left,Enum.Font.Gotham,16,o;b0.Text=("%d) %s"):format(aZ,bW(ad))local function c2(bw,bP)local bk=Instance.new("TextButton",c1)bk.Text,bk.Size,bk.Position=bw,UDim2.fromOffset(26,26),UDim2.new(1,bP,0,4)bk.BackgroundColor3=m;bk.TextColor3=p;Instance.new("UICorner",bk).CornerRadius=UDim.new(0,6)return bk end;local c3=c2("↑",-160)local c4=c2("↓",-130)local c5=c2("✕",-100)j(c3.MouseButton1Click:Connect(function()if aZ>1 then table.insert(ai.steps,aZ-1,table.remove(ai.steps,aZ))af()c0(ai)end end))j(c4.MouseButton1Click:Connect(function()if aZ<#ai.steps then table.insert(ai.steps,aZ+1,table.remove(ai.steps,aZ))af()c0(ai)end end))j(c5.MouseButton1Click:Connect(function()table.remove(ai.steps,aZ)af()c0(ai)end))end end;local function c6(ah)w.state.selected=ah;for ac,bL in ipairs(bH:GetChildren())do bL:Destroy()end;local c7=Instance.new("TextLabel",bH)c7.Text,c7.Font,c7.TextSize,c7.TextColor3,c7.BackgroundTransparency,c7.Size,c7.TextXAlignment=("Editing: %s"):format(ah or"—"),Enum.Font.GothamSemibold,18,q,1,UDim2.new(1,-12,0,26),Enum.TextXAlignment.Left;c7.Position=UDim2.new(0,8,0,8)if not ah then return end;local ai=v.list[ah]if not ai then return end;bY=Instance.new("ScrollingFrame",bH)bY.Position=UDim2.new(0,8,0,40)bY.Size=UDim2.new(1,-16,1,-210)bY.AutomaticCanvasSize=Enum.AutomaticSize.Y;bY.ScrollBarThickness=6;bY.BackgroundTransparency=1;local c8=Instance.new("UIListLayout",bY)c8.Padding,c8.SortOrder=UDim.new(0,4),Enum.SortOrder.LayoutOrder;c8.FillDirection=Enum.FillDirection.Vertical;local c9=Instance.new("Frame",bH)c9.Size=UDim2.new(1,-16,0,180)c9.Position=UDim2.new(0,8,1,-188)c9.BackgroundColor3=n;Instance.new("UICorner",c9).CornerRadius=UDim.new(0,8)do local H=Instance.new("UIPadding",c9)H.PaddingLeft=UDim.new(0,8)H.PaddingRight=UDim.new(0,8)H.PaddingTop=UDim.new(0,8)H.PaddingBottom=UDim.new(0,8)end;local ca=32;local cb=Instance.new("Frame",c9)cb.BackgroundTransparency=1;cb.Position=UDim2.new(0,0,0,0)cb.Size=UDim2.new(1,0,0,ca)local cc="KeyTap"local cd=Instance.new("TextButton",cb)cd.Size=UDim2.fromOffset(180,28)cd.Position=UDim2.new(0,0,0,2)cd.BackgroundColor3=m;cd.TextColor3=p;cd.Text="Event: KeyTap"Instance.new("UICorner",cd).CornerRadius=UDim.new(0,6)local ce=Instance.new("TextButton",cb)local cf=Instance.new("TextButton",cb)ce.BackgroundColor3=m;ce.TextColor3=p;ce.Text="Add Step"Instance.new("UICorner",ce).CornerRadius=UDim.new(0,6)cf.BackgroundColor3=m;cf.TextColor3=q;cf.Text="Save"Instance.new("UICorner",cf).CornerRadius=UDim.new(0,6)local cg,ch=140,200;local ci,cj=110,120;local ck,cl=8,8;local function cm()task.defer(function()local cn=cb.AbsoluteSize.X;local co=180+ck;local cp=cn-co-cl;local cq=ch+ck+cg;local cr=cp-cq;local cs,ct=ch,cg;if cr<0 then local cu=math.min(ch-cj,-cr)cs=ch-cu;cr=cr+cu;if cr<0 then local cv=math.min(cg-ci,-cr)ct=cg-cv;cr=cr+cv end end;cf.Size=UDim2.fromOffset(cs,28)cf.Position=UDim2.new(1,-cl-cs,0,2)ce.Size=UDim2.fromOffset(ct,28)ce.Position=UDim2.new(1,-cl-cs-ck-ct,0,2)end)end;j(cb:GetPropertyChangedSignal("AbsoluteSize"):Connect(cm))j(c9:GetPropertyChangedSignal("AbsoluteSize"):Connect(cm))cm()local cw={"KeyTap","KeyHold","MouseClick","Wait","Teleport","Reset","RunCode","SendToWebhook"}local cx=Instance.new("ScrollingFrame",c9)cx.Position=UDim2.new(0,0,0,ca+6)cx.Size=UDim2.fromOffset(180,math.min(8+#cw*26,140))cx.AutomaticCanvasSize=Enum.AutomaticSize.Y;cx.ScrollBarThickness=6;cx.BackgroundColor3=m;cx.Visible=false;cx.ZIndex=10;Instance.new("UICorner",cx).CornerRadius=UDim.new(0,6)local cy=Instance.new("UIPadding",cx)cy.PaddingTop,cy.PaddingLeft=UDim.new(0,4),UDim.new(0,4)local cz=Instance.new("UIListLayout",cx)cz.Padding=UDim.new(0,4)for ac,bM in ipairs(cw)do local bk=Instance.new("TextButton",cx)bk.Size=UDim2.new(1,-8,0,22)bk.BackgroundColor3=n;bk.TextColor3=o;bk.Text=bM;bk.ZIndex=11;Instance.new("UICorner",bk).CornerRadius=UDim.new(0,4)j(bk.MouseButton1Click:Connect(function()cc=bM;cd.Text="Event: "..bM;cx.Visible=false;if w.refs.buildParamFields then w.refs.buildParamFields()end end))end;j(cd.MouseButton1Click:Connect(function()cx.Visible=not cx.Visible end))local cA=Instance.new("Frame",c9)cA.BackgroundTransparency=1;cA.Position=UDim2.new(0,0,0,ca+12)cA.Size=UDim2.new(1,0,1,-(ca+12))local cB=8;local function cC(bo,b1,cD,cE)local cF=Instance.new("TextLabel",bo)cF.BackgroundTransparency=1;cF.TextXAlignment=Enum.TextXAlignment.Left;cF.Font=Enum.Font.Gotham;cF.TextSize=16;cF.TextColor3=o;cF.Position=UDim2.new(cD,0,0,0)cF.Size=UDim2.new(cE,-cB,0,20)cF.Text=b1;cF.TextTruncate=Enum.TextTruncate.AtEnd;return cF end;local function cG(bo,cH,cD,cE,ah,cI,cJ)local bt=Instance.new("TextBox",bo)bt.Name=ah or""bt.Text=cH or""bt.PlaceholderText=cJ or""bt.Size=UDim2.new(cE,-cB,0,cI and 54 or 26)bt.Position=UDim2.new(cD,0,0,22)bt.BackgroundColor3=m;bt.TextColor3=o;bt.Font=Enum.Font.Gotham;bt.TextSize=16;bt.TextWrapped=cI or false;bt.ClearTextOnFocus=false;bt.ClipsDescendants=true;Instance.new("UICorner",bt).CornerRadius=UDim.new(0,6)return bt end;local function cK()for ac,bL in ipairs(cA:GetChildren())do bL:Destroy()end;if cc=="KeyTap"or cc=="KeyHold"then cC(cA,"Key (E, 1, Space…)",0.00,0.48)cG(cA,a.Options.MACRO_Hotkey and a.Options.MACRO_Hotkey.Value or"E",0.00,0.48,"Key")if cc=="KeyHold"then cC(cA,"Hold (ms)",0.50,0.22)cG(cA,"80",0.50,0.22,"Hold")end elseif cc=="MouseClick"then cC(cA,"Button",0.00,0.36)cG(cA,"Left",0.00,0.36,"Btn",false,"Left / Right / Middle")cC(cA,"Hold (ms)",0.40,0.20)cG(cA,"40",0.40,0.20,"Hold")elseif cc=="Wait"then cC(cA,"Wait (ms)",0.00,0.30)cG(cA,"150",0.00,0.30,"Wait")elseif cc=="Teleport"then cC(cA,"Speed (stud/s)",0.00,0.30)cG(cA,"200",0.00,0.30,"Speed")cC(cA,"Location (coordinates optional)",0.34,0.64)cG(cA,"",0.34,0.18,"X")cG(cA,"",0.54,0.18,"Y")cG(cA,"",0.74,0.18,"Z")elseif cc=="SendToWebhook"then cC(cA,"Webhook URL",0.00,0.60)local cL=cG(cA,"",0.00,0.60,"WebhookUrl",false,"https://discord.com/api/webhooks/...")cC(cA,"Title",0.62,0.38)local cM=cG(cA,"Cerberus Event",0.62,0.38,"Title",false,"Short title")local cN=7;local cO=28;local cP=22+cO+cN;local cQ=cC(cA,"Description",0.00,1.00)cQ.Position=UDim2.new(0.00,0,0,cP)local cR=cG(cA,"",0.00,1.00,"Description",true,"Optional details shown in the embed")cR.Position=UDim2.new(0.00,0,0,cP+15)elseif cc=="Reset"then elseif cc=="RunCode"then cC(cA,"Mode",0.00,0.24)local cS=Instance.new("TextButton",cA)cS.Size=UDim2.new(0.24,-cB,0,26)cS.Position=UDim2.new(0.00,0,0,22)cS.BackgroundColor3=m;cS.TextColor3=o;cS.Font=Enum.Font.Gotham;cS.TextSize=16;cS.Text="File ▼"Instance.new("UICorner",cS).CornerRadius=UDim.new(0,6)cA:SetAttribute("RunCodeMode","File")local cT=Instance.new("Frame",cA)cT.Position=UDim2.new(0.00,0,0,50)cT.Size=UDim2.new(0.24,-cB,0,84)cT.BackgroundColor3=m;cT.Visible=false;cT.ZIndex=10;Instance.new("UICorner",cT).CornerRadius=UDim.new(0,6)local bI=Instance.new("UIListLayout",cT)bI.Padding=UDim.new(0,2)for ac,cU in ipairs({"File","URL","Raw"})do local bk=Instance.new("TextButton",cT)bk.Size=UDim2.new(1,-4,0,24)bk.BackgroundColor3=n;bk.TextColor3=o;bk.Text=cU;bk.ZIndex=11;Instance.new("UICorner",bk).CornerRadius=UDim.new(0,4)j(bk.MouseButton1Click:Connect(function()cS.Text=cU.." ▼"cT.Visible=false;cA:SetAttribute("RunCodeMode",cU)end))end;j(cS.MouseButton1Click:Connect(function()cT.Visible=not cT.Visible end))cC(cA,"Value",0.26,0.72)cG(cA,"",0.26,0.72,"Value",true,"Path / URL / Code")end end;w.refs.buildParamFields=cK;cK()j(ce.MouseButton1Click:Connect(function()local cV={}for ac,bL in ipairs(cA:GetChildren())do if bL:IsA("TextBox")then cV[bL.Name]=bL.Text end end;local av=e.humanoidRootPart;if cc=="KeyTap"then local C=y(cV.Key or"")if C then table.insert(ai.steps,{type="KeyTap",key=C})end elseif cc=="KeyHold"then local C=y(cV.Key or"")local cW=tonumber(cV.Hold or"")or 80;if C then table.insert(ai.steps,{type="KeyHold",key=C,hold=cW/1000})end elseif cc=="MouseClick"then local F=cV.Btn or"Left"local cW=tonumber(cV.Hold or"")or 40;table.insert(ai.steps,{type="MouseClick",button=F,hold=cW/1000})elseif cc=="Wait"then local cX=tonumber(cV.Wait or"")or 150;table.insert(ai.steps,{type="Wait",wait=cX/1000})elseif cc=="Teleport"then local au=tonumber(cV.Speed or"")or 200;local cY,cZ,c_;if cV.X~=""and cV.Y~=""and cV.Z~=""then cY,cZ,c_=tonumber(cV.X),tonumber(cV.Y),tonumber(cV.Z)end;local aq=cY and cZ and c_ and Vector3.new(cY,cZ,c_)or av and av.Position or Vector3.new()table.insert(ai.steps,{type="Teleport",pos=aq,speed=au})elseif cc=="SendToWebhook"then local a2=(cV.WebhookUrl or""):gsub("^%s+",""):gsub("%s+$","")local d0=cV.Title or""local d1=cV.Description or""if a2==""then d:Notify("Please enter a webhook URL.",3)else table.insert(ai.steps,{type="SendToWebhook",webhookUrl=a2,title=d0,description=d1})end elseif cc=="Reset"then table.insert(ai.steps,{type="Reset"})elseif cc=="RunCode"then local d2=cA:GetAttribute("RunCodeMode")or"File"if d2=="Raw"then d2="Inline"end;local d3=cV.Value or""table.insert(ai.steps,{type="RunCode",mode=d2,value=d3})end;af()c0(ai)end))j(cf.MouseButton1Click:Connect(function()af()bi()d:Notify("Macros saved & runner refreshed.",3)end))c0(ai)end;w.refs.selectMacro=c6;bK()if bf and v.list[bf]then c6(bf)elseif v.order[1]then c6(v.order[1])else c6(nil)end end})s:AddButton({Text="Refresh Macros",Tooltip="Reload macros from disk and sync the runner UI",Func=function()ak()bi()d:Notify("Macros reloaded.",2)end})ak()if#v.order==0 then v.list["Macro 1"]={steps={},interval=1.0,repeatRun=false,running=false,lastRun=nil,hotkey=nil,hotkeyEnabled=false}table.insert(v.order,"Macro 1")af()end;bi()aE()if g then g:Register(function()for aZ=#i,1,-1 do local bL=i[aZ]i[aZ]=nil;pcall(function()if bL and bL.Disconnect then bL:Disconnect()end end)end end)end end
