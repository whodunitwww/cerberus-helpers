return function(a)local b=a.Services;local c=a.Tabs;local d=a.References;local e=a.Library;local f=a.Options;local g=a.Toggles;local h=a.Unloader;local i=a.MovementConfig;local j={}if i.Enabled~=true then return end;local k={}local function l(m)if m then k[#k+1]=m end end;if i.Flight.Enabled then local n=c.Player:AddLeftGroupbox("Flight","move-3d")n:AddToggle("FlightEnabled",{Text="Flight",Default=false}):AddKeyPicker("FlightKey",{Default="Y",SyncToggleState=true,Mode="Toggle"})if i.Flight.FlightSpeed.Enabled then n:AddSlider("FlightSpeed",{Text="Flight Speed",Default=i.Flight.FlightSpeed.Default or 100,Min=i.Flight.FlightSpeed.Min or 30,Max=i.Flight.FlightSpeed.Max or 400,Rounding=0})else f.FlightSpeed.Value=100 end;local o;local function startFlight()if o then return end;e:Notify("Flight enabled.",2)o=l(b.RunService.RenderStepped:Connect(function()if not d.humanoidRootPart or not d.camera then return end;local p=d.camera.CFrame;local q,r,s=p.LookVector,p.RightVector,p.UpVector;local t=Vector3.zero;local u=Enum.KeyCode;if b.UserInputService:IsKeyDown(u.W)then t=t+q end;if b.UserInputService:IsKeyDown(u.S)then t=t-q end;if b.UserInputService:IsKeyDown(u.A)then t=t-r end;if b.UserInputService:IsKeyDown(u.D)then t=t+r end;if b.UserInputService:IsKeyDown(u.Space)then t=t+s end;if b.UserInputService:IsKeyDown(u.LeftShift)or b.UserInputService:IsKeyDown(u.LeftControl)then t=t-s end;if d.humanoid and b.UserInputService.TouchEnabled then local v=d.humanoid.MoveDirection;if v.Magnitude>0 then t=t+q*v.Z*-1+r*v.X end end;local w=f.FlightSpeed.Value;if t.Magnitude>0 then d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=t.Unit*w else d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=Vector3.new(0,2.2,0)end end))end;local function stopFlight()if o then e:Notify("Flight disabled.",2)o:Disconnect()o=nil;if d.humanoidRootPart then d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=Vector3.zero end end end;g.FlightEnabled:OnChanged(function()if g.FlightEnabled.Value then startFlight()else stopFlight()end end)end;if i.Speed.Enabled then local x=c.Player:AddLeftGroupbox("Speed","move")x:AddToggle("SpeedEnabled",{Text="Speed",Default=false}):AddKeyPicker("SpeedKey",{Default="G",SyncToggleState=true,Mode="Toggle"})if i.Speed.SpeedSlider.Enabled then x:AddSlider("SpeedValue",{Text="Speed Value",Default=i.Speed.SpeedSlider.Default or 30,Min=i.Speed.SpeedSlider.Min or 16,Max=i.Speed.SpeedSlider.Max or 300,Rounding=0})end;local y;local function startSpeed()if y then return end;e:Notify("Speed enabled.",2)y=l(b.RunService.Heartbeat:Connect(function()if d.humanoid then local w=f.SpeedValue.Value;d.humanoid.WalkSpeed=w end end))end;local function stopSpeed()if y then e:Notify("Speed disabled.",2)y:Disconnect()y=nil end;if d.humanoid then d.humanoid.WalkSpeed=16 end end;g.SpeedEnabled:OnChanged(function()if g.SpeedEnabled.Value then startSpeed()else stopSpeed()end end)end;if i.Jump.Enabled then local z=c.Player:AddLeftGroupbox("Jump","move-vertical")z:AddToggle("JumpPower",{Text="Jump Power",Default=false})if i.Jump.JumpHeight.Enabled then z:AddSlider("JumpHeight",{Text="Jump Height",Default=i.Jump.JumpHeight.Default or 7.2,Min=i.Jump.JumpHeight.Min or 5,Max=i.Jump.JumpHeight.Max or 200,Rounding=1})else f.JumpHeight.Value=7.2 end;if i.Jump.InfiniteJump then z:AddToggle("InfiniteJump",{Text="Infinite Jump",Default=false})else g.InfiniteJump.Value=false end;local function A()if not d.humanoid then return end;local B=tonumber(f.JumpHeight.Value)or 50;local C=workspace.Gravity or 196.2;local D=math.sqrt(math.max(0,2*C*B))if d.humanoid.UseJumpPower~=nil then d.humanoid.UseJumpPower=true end;if d.humanoid.JumpPower~=nil then d.humanoid.JumpPower=D end end;local E=nil;local F;local function startJumpMod()if F then return end;local G=d.humanoid;if G and not E then E={UseJumpPower=G.UseJumpPower,JumpPower=G.JumpPower,JumpHeight=G.JumpHeight}end;A()F=l(b.RunService.Heartbeat:Connect(function()A()end))end;local function stopJumpMod()if F then F:Disconnect()F=nil end;local G=d.humanoid;if G and E then if G.UseJumpPower~=nil then G.UseJumpPower=E.UseJumpPower end;if G.JumpPower~=nil then G.JumpPower=E.JumpPower end;if G.JumpHeight~=nil then G.JumpHeight=E.JumpHeight end end end;local H,I=nil,false;local function startInfiniteJump()if H then return end;H=l(b.UserInputService.JumpRequest:Connect(function()if not g.InfiniteJump.Value then return end;local G=d.humanoid;if not G or I then return end;I=true;task.defer(function()pcall(function()G:ChangeState(Enum.HumanoidStateType.Jumping)G.Jump=true end)task.wait()I=false end)end))end;local function stopInfiniteJump()if H then H:Disconnect()H=nil end;I=false end;g.JumpPower:OnChanged(function()if g.JumpPower.Value then startJumpMod()else stopJumpMod()end end)if i.Jump.JumpHeight then f.JumpHeight:OnChanged(function()if g.JumpPower.Value then A()end end)end;if i.Jump.InfiniteJump then g.InfiniteJump:OnChanged(function()if g.InfiniteJump.Value then startInfiniteJump()else stopInfiniteJump()end end)end end;if i.ClickToTp then local J=c.Player:AddLeftGroupbox("Click Teleport","mouse-pointer-click")J:AddToggle("ClickTPEnabled",{Text="Click To Teleport",Default=false,Tooltip="Hold the chosen key and right-click anywhere to instantly teleport there."}):AddKeyPicker("ClickTPKey",{Default="Q",SyncToggleState=false,Mode="Hold"})local K;local function L()if K then return end;K=l(b.UserInputService.InputBegan:Connect(function(M,N)if N then return end;if M.UserInputType==Enum.UserInputType.MouseButton2 and b.UserInputService:IsKeyDown(Enum.KeyCode[f.ClickTPKey.Value])then local O=b.UserInputService:GetMouseLocation()local P=d.camera:ViewportPointToRay(O.X,O.Y)local Q=workspace:Raycast(P.Origin,P.Direction*1000,RaycastParams.new())if Q and d.humanoidRootPart then d.humanoidRootPart.CFrame=CFrame.new(Q.Position+Vector3.new(0,3,0))end end end))end;local function R()if K then K:Disconnect()K=nil end end;g.ClickTPEnabled:OnChanged(function()if g.ClickTPEnabled.Value then L()else R()end end)f.ClickTPKey:OnChanged(function()end)end;if i.CTW.Enabled then local S=c.Player:AddLeftGroupbox("Click To Walk","mouse-pointer")S:AddToggle("ClickToWalk",{Text="Enable Click To Walk",Default=false})if i.CTW.WalkSpeed.Enabled then S:AddSlider("CTW_Speed",{Text="Walk Speed",Default=i.CTW.WalkSpeed.Default or 16,Min=i.CTW.WalkSpeed.Min or 8,Max=i.CTW.WalkSpeed.Max or 300,Rounding=0,Suffix=" studs/s"})else f.CTW_Speed.Value=16 end;local T=i.Dev.MaxHopDistance or 700;local U=i.Dev.MinRepathInterval or 0.3;local V=0;local W,X,Y,Z;local _;local a0;local a1;local a2;local a3=nil;local a4=0;local a5=false;local a6=nil;local a7={}local function a8()local G=d.humanoid;if not G then return end;if a6==nil then a6=G.WalkSpeed end;G.WalkSpeed=f.CTW_Speed.Value end;local function a9()local G=d.humanoid;if G and a6~=nil then G.WalkSpeed=a6 end;a6=nil end;local function aa(ab)if not ab then return end;for ac,ad in ipairs(ab:GetDescendants())do if ad:IsA("BasePart")then b.TweenService:Create(ad,TweenInfo.new(0.25),{Transparency=1}):Play()end end;task.delay(0.3,function()pcall(function()if ab then ab:Destroy()end end)end)end;local function ae()if Z then Z:Disconnect()Z=nil end;if a1 then aa(a1)a1=nil end end;local function af()if a0 then aa(a0)a0=nil end end;local function ag()ae()af()end;local function ah()local G,ai=d.humanoid,d.humanoidRootPart;if G then pcall(function()if ai then G:MoveTo(ai.Position)end end)pcall(function()G:Move(Vector3.zero)end)end end;local function aj()if X then X:Disconnect()X=nil end;if Y then Y:Disconnect()Y=nil end;_=nil end;local function ak()for al,am in pairs(a7)do if am then am:Disconnect()end;a7[al]=nil end end;local function an()if not a5 then ag()aj()a9()ak()a2,a3,a4=nil,nil,0;return end;a5=false;ah()ag()aj()a9()ak()a2,a3,a4=nil,nil,0 end;local function ao()an()if W then W:Disconnect()W=nil end end;local function ap(aq)ae()a1=Instance.new("Folder")a1.Name="CTW_Beacon"a1.Parent=workspace;local ar=Instance.new("Part")ar.Name="Pillar"ar.Anchored,ar.CanCollide=true,false;ar.Material=Enum.Material.Neon;ar.Color=Color3.fromRGB(55,235,120)ar.Size=Vector3.new(0.25,12,0.25)ar.CFrame=CFrame.new(aq+Vector3.new(0,ar.Size.Y/2,0))ar.Parent=a1;local as=Instance.new("Part")as.Name="Ring"as.Shape=Enum.PartType.Cylinder;as.Anchored,as.CanCollide=true,false;as.Material=Enum.Material.Neon;as.Color=Color3.fromRGB(55,235,120)as.Size=Vector3.new(2,0.2,2)as.CFrame=CFrame.new(aq)*CFrame.Angles(math.rad(90),0,0)as.Parent=a1;local at=Instance.new("Part")at.Name="Glow"at.Anchored,at.CanCollide=true,false;at.Material=Enum.Material.Neon;at.Color=Color3.fromRGB(55,235,120)at.Transparency=0.5;at.Size=Vector3.new(1.5,0.15,1.5)at.CFrame=CFrame.new(aq+Vector3.new(0,0.05,0))at.Parent=a1;b.TweenService:Create(as,TweenInfo.new(0.8,Enum.EasingStyle.Quad,Enum.EasingDirection.Out,-1,true),{Size=Vector3.new(6,as.Size.Y,6)}):Play()b.TweenService:Create(ar,TweenInfo.new(0.8,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut,-1,true),{Transparency=0.25}):Play()local au=0;Z=l(b.RunService.Heartbeat:Connect(function(av)if not as or not as.Parent then return end;au=au+av*math.pi/2;as.CFrame=CFrame.new(aq)*CFrame.Angles(math.rad(90),au,0)end))end;local function aw(ax)af()a0=Instance.new("Folder")a0.Name="CTW_Path"a0.Parent=workspace;for ay=1,#ax do local az=Instance.new("Part")az.Name="CTW_Waypoint"az.Anchored,az.CanCollide=true,false;az.Material=Enum.Material.Neon;az.Color=Color3.fromRGB(55,235,120)az.Size=Vector3.new(0.35,0.35,0.35)az.Shape=Enum.PartType.Ball;az.CFrame=CFrame.new(ax[ay].Position+Vector3.new(0,0.15,0))az.Parent=a0 end;for ay=1,#ax-1 do local aA,aB=ax[ay].Position,ax[ay+1].Position;local aC=Instance.new("Part")aC.Name="CTW_Segment"aC.Anchored,aC.CanCollide=true,false;aC.Material=Enum.Material.Neon;aC.Color=Color3.fromRGB(55,235,120)aC.Size=Vector3.new(0.15,0.15,(aA-aB).Magnitude)aC.CFrame=CFrame.new((aA+aB)/2,aB)aC.Transparency=1;aC.Parent=a0;b.TweenService:Create(aC,TweenInfo.new(0.2),{Transparency=0}):Play()end end;local function aD(aE,aF)local aG=aF-aE;local aH=aG.Magnitude;if aH<1 then return{aF}end;local t=aG.Unit;local aI,aJ={},0;while aJ+T<aH do aJ=aJ+T;aI[#aI+1]=aE+t*aJ end;aI[#aI+1]=aF;return aI end;local function aK(aL,aA,aB)local aM=os.clock()local aN=U-(aM-V)if aN>0 then task.wait(aN)end;V=os.clock()local aO,aP=pcall(function()aL:ComputeAsync(aA,aB)end)if not aO then return false,aP end;return true end;local function aQ()ak()a7.WASD=l(b.UserInputService.InputBegan:Connect(function(M,N)if N then return end;local aR=M.KeyCode;if aR==Enum.KeyCode.W or aR==Enum.KeyCode.A or aR==Enum.KeyCode.S or aR==Enum.KeyCode.D then an()end end))a7.GP=l(b.UserInputService.InputChanged:Connect(function(M,N)if N then return end;if M.UserInputType==Enum.UserInputType.Gamepad1 and M.KeyCode==Enum.KeyCode.Thumbstick1 then if M.Position.Magnitude>0.15 then an()end end end))a7.RMB=l(b.UserInputService.InputBegan:Connect(function(M,N)if N then return end;if M.UserInputType==Enum.UserInputType.MouseButton2 then an()end end))if d.player then a7.CharAdded=l(d.player.CharacterAdded:Connect(function()an()end))end;local G=d.humanoid;if G then a7.Died=l(G.Died:Connect(an))a7.Seated=l(G.Seated:Connect(function(aS)if aS then an()end end))a7.Ancestry=l(G.AncestryChanged:Connect(function(ac,aT)if aT==nil then an()end end))end end;local function aU(aV,aW)if not a5 then return end;local aX=b.PathfindingService:CreatePath({AgentRadius=2,AgentHeight=5,AgentCanJump=true,WaypointSpacing=4})_=aX;local aO=aK(aX,aV,aW)if not aO or aX.Status~=Enum.PathStatus.Success then local aY=aV:Lerp(aW,0.5)aO=aK(aX,aV,aY)if not aO or aX.Status~=Enum.PathStatus.Success then e:Notify("Unable to compute path.",3)an()return else if a3 then table.insert(a3,a4,aY)end end end;if not a5 then return end;local aZ=aX:GetWaypoints()if#aZ==0 then e:Notify("No waypoints for this segment.",3)an()return end;aw(aZ)if Y then Y:Disconnect()Y=nil end;Y=l(aX.Blocked:Connect(function()if not a5 then return end;local ai=d.humanoidRootPart;if ai and a2 and a3 then aU(ai.Position,a3[a4])end end))if X then X:Disconnect()X=nil end;local ay=1;local G=d.humanoid;if not G then an()return end;G:MoveTo(aZ[ay].Position)X=l(G.MoveToFinished:Connect(function(a_)if not a5 then return end;if _~=aX then return end;if not a_ then local ai=d.humanoidRootPart;if ai and a3 then aU(ai.Position,a3[a4])else an()end;return end;ay=ay+1;if aZ[ay]then G:MoveTo(aZ[ay].Position)else a4=a4+1;if a3 and a3[a4]then local ai=d.humanoidRootPart;if ai then aU(ai.Position,a3[a4])else an()end else an()end end end))end;local function b0()if W then return end;W=l(b.UserInputService.InputBegan:Connect(function(M,N)if N then return end;if M.UserInputType~=Enum.UserInputType.MouseButton1 then return end;local b1=d.player and d.player:GetMouse()if not b1 or not b1.Hit then return end;local aF=b1.Hit.Position;if a5 then an()end;a2=aF;ag()ap(aF)local ai=d.humanoidRootPart;local G=d.humanoid;if not(ai and G)then an()return end;a5=true;a8()aQ()a3=aD(ai.Position,aF)a4=1;aU(ai.Position,a3[a4])end))end;g.ClickToWalk:OnChanged(function()if g.ClickToWalk.Value then b0()else ao()end end)f.CTW_Speed:OnChanged(function(w)if a5 and d.humanoid then d.humanoid.WalkSpeed=w end end)end;if i.Flight.Enabled then j.startFlight=startFlight;j.stopFlight=stopFlight end;if i.Jump.Enabled then j.startJumpMod=startJumpMod;j.stopJumpMod=stopJumpMod;j.startInfiniteJump=startInfiniteJump;j.stopInfiniteJump=stopInfiniteJump end;if i.Speed.Enabled then j.startSpeed=startSpeed;j.stopSpeed=stopSpeed end;if h then h:Register(function()for ay=#k,1,-1 do local am=k[ay]k[ay]=nil;pcall(function()if am and am.Disconnect then am:Disconnect()end end)end end)end;return j end
