return function(a)local b=a.Services;local c=a.Tabs;local d=a.References;local e=a.Library;local f=a.Options;local g=a.Toggles;local h=a.Unloader;local i=a.VisualsConfig;if i.Enabled~=true then return end;local j={}local function k(l)if l then j[#j+1]=l end end;if i.Radar.Enabled then local m=c.ESP:AddRightGroupbox("Player Radar","map")local n={gui=nil,conn=nil,range=500,scale=1,mode="Camera",rings={},_holder=nil,_centerIcon=nil,buildRings=nil,updateRings=nil}local function o()if n.conn then n.conn:Disconnect()n.conn=nil end;if n.gui then n.gui:Destroy()n.gui=nil end;n.rings={}n._holder,n._centerIcon=nil,nil end;local function p()o()local q=gethui and gethui()or b.CoreGui;local r=Instance.new("ScreenGui")r.Name="CerberusRadar"r.ResetOnSpawn=false;r.IgnoreGuiInset=true;r.ZIndexBehavior=Enum.ZIndexBehavior.Sibling;r.Parent=q;n.gui=r;local s=Instance.new("Frame")s.Name="Holder"s.AnchorPoint=Vector2.new(1,1)s.Position=UDim2.new(1,-20,1,-20)s.Size=UDim2.fromOffset(200*n.scale,200*n.scale)s.BackgroundColor3=Color3.fromRGB(25,25,25)s.BackgroundTransparency=0.2;s.Active=true;s.ClipsDescendants=false;s.Parent=r;local t=Instance.new("UICorner",s)t.CornerRadius=UDim.new(1,0)local u=Instance.new("UIStroke",s)u.Thickness=2;u.Color=Color3.fromRGB(92,94,104)u.Transparency=0.3;local v=Instance.new("ImageLabel")v.BackgroundTransparency=1;v.Image="rbxassetid://136497541793809"v.ImageColor3=Color3.fromRGB(55,235,120)v.AnchorPoint=Vector2.new(0.5,0.5)v.Position=UDim2.fromScale(0.5,0.5)v.Size=UDim2.fromOffset(22*n.scale,22*n.scale)v.Parent=s;local function w()for x,y in ipairs(n.rings)do y.Frame:Destroy()end;n.rings={}for x,z in ipairs({0.25,0.75})do local A=Instance.new("Frame")A.Name="Ring"A.BackgroundTransparency=1;A.SizeConstraint=Enum.SizeConstraint.RelativeXX;A.Size=UDim2.fromScale(z,z)A.AnchorPoint=Vector2.new(0.5,0.5)A.Position=UDim2.fromScale(0.5,0.5)A.Parent=s;local B=Instance.new("UICorner",A)B.CornerRadius=UDim.new(1,0)local C=Instance.new("UIStroke",A)C.Color=Color3.fromRGB(60,60,60)C.Thickness=1;C.Transparency=0.6;local D=Instance.new("TextLabel")D.Name="Studs"D.BackgroundTransparency=1;D.Font=Enum.Font.Gotham;D.TextColor3=Color3.fromRGB(150,150,150)D.TextSize=10*n.scale;D.AnchorPoint=Vector2.new(0.5,0)D.Position=UDim2.new(0.5,0,1,2*n.scale)D.ZIndex=5;D.Parent=A;table.insert(n.rings,{Frame=A,Label=D,Percent=z})end end;local function E()for x,y in ipairs(n.rings)do y.Label.Text=string.format("%d studs",math.floor(y.Percent*n.range+0.5))y.Label.TextSize=10*n.scale;y.Label.Position=UDim2.new(0.5,0,1,2*n.scale)end end;w()E()do local F,G,H;k(s.InputBegan:Connect(function(I)if I.UserInputType==Enum.UserInputType.MouseButton1 or I.UserInputType==Enum.UserInputType.Touch then F=true;G=I.Position;H=s.Position;k(I.Changed:Connect(function()if I.UserInputState==Enum.UserInputState.End then F=false end end))end end))k(s.InputChanged:Connect(function(I)if F and(I.UserInputType==Enum.UserInputType.MouseMovement or I.UserInputType==Enum.UserInputType.Touch)then local J=I.Position-G;s.Position=UDim2.new(H.X.Scale,H.X.Offset+J.X,H.Y.Scale,H.Y.Offset+J.Y)end end))end;n.conn=k(b.RunService.Heartbeat:Connect(function()local K=d.humanoidRootPart;if not K then return end;for x,L in ipairs(s:GetChildren())do if L.Name=="Blip"and L:IsA("Frame")then L:Destroy()end end;local M=s.AbsoluteSize;local N=Vector2.new(M.X/2,M.Y/2)local O=math.min(M.X,M.Y)/2-12*n.scale;local P=b.Teams and#b.Teams:GetChildren()>0;local Q=b.Players.LocalPlayer.Team;local R=b.Workspace.CurrentCamera;local S=R and R.CFrame.RightVector;local T=R and R.CFrame.LookVector;for x,U in ipairs(b.Players:GetPlayers())do if U~=d.player and U.Character then local V=U.Character:FindFirstChild("HumanoidRootPart")if V then local W=V.Position-K.Position;local X=W.Magnitude;if X<=n.range then local Y,Z;if n.mode=="Camera"and S and T then Y=W:Dot(S)Z=-W:Dot(T)else Y=W.X;Z=W.Z end;local _=Vector2.new(Y,Z)/n.range*O;local a0=P and(U.Team~=nil and Q~=nil and U.Team==Q)local a1=Instance.new("Frame")a1.Name="Blip"a1.AnchorPoint=Vector2.new(0.5,0.5)a1.Size=UDim2.fromOffset(8*n.scale,8*n.scale)a1.Position=UDim2.fromOffset(N.X+_.X,N.Y+_.Y)a1.BackgroundColor3=a0 and Color3.fromRGB(55,235,120)or Color3.fromRGB(235,55,55)a1.BorderSizePixel=0;a1.ZIndex=10;a1.Parent=s;local a2=Instance.new("UICorner",a1)a2.CornerRadius=UDim.new(1,0)end end end end end))n._holder=s;n._centerIcon=v;n.buildRings=w;n.updateRings=E end;m:AddToggle("Radar_Enable",{Text="Enable Radar",Default=false,Callback=function(a3)if a3 then p()else o()end end})if i.Radar.RadarRange.Enabled then m:AddSlider("Radar_Range",{Text="Range",Default=i.Radar.RadarRange.Default or 500,Min=i.Radar.RadarRange.Min or 100,Max=i.Radar.RadarRange.Max or 2000,Rounding=0,Suffix=" studs",Callback=function(a3)n.range=a3;if n.updateRings then n.updateRings()end end})end;if i.Radar.RadarScale.Enabled then m:AddSlider("Radar_Scale",{Text="HUD Scale",Default=i.Radar.RadarScale.Default or 100,Min=i.Radar.RadarScale.Min or 50,Max=i.Radar.RadarScale.Max or 200,Rounding=0,Suffix="%",Callback=function(a3)n.scale=a3/100;if n.gui and n._holder then local a4=n._holder;a4.Size=UDim2.fromOffset(200*n.scale,200*n.scale)if n._centerIcon then n._centerIcon.Size=UDim2.fromOffset(22*n.scale,22*n.scale)end;for x,y in ipairs(n.rings)do y.Label.TextSize=10*n.scale;y.Label.Position=UDim2.new(0.5,0,1,2*n.scale)end end end})end;if i.Radar.RadarMode then m:AddDropdown("Radar_Mode",{Text="Rotation Mode",Values={"Camera","North"},Default="Camera",Callback=function(a3)n.mode=a3 end})else n.mode="Camera"end end;if i.Visuals.Enabled then local a5=c.Player:AddRightGroupbox("Visuals","glasses")if i.Visuals.InfiniteCam then a5:AddToggle("InfiniteCamera",{Text="Infinite Camera Max",Default=false})local a6;g.InfiniteCamera:OnChanged(function()local U=d.player;if not U then return end;if g.InfiniteCamera.Value then a6=a6 or U.CameraMaxZoomDistance;U.CameraMaxZoomDistance=1e10 else U.CameraMaxZoomDistance=a6 or 128;a6=nil end end)end;if i.Visuals.NoFog then a5:AddToggle("NoFog",{Text="No Fog",Default=false})local a7,a8;local function a9(aa)if not a8 then return end;if aa:IsA("BloomEffect")or aa:IsA("SunRaysEffect")or aa:IsA("DepthOfFieldEffect")or aa:IsA("ColorCorrectionEffect")or aa:IsA("BlurEffect")then if aa.Enabled then aa:SetAttribute("NFWasEnabled",true)aa.Enabled=false end elseif aa:IsA("Atmosphere")then if a8.Atmo[aa]==nil then a8.Atmo[aa]={D=aa.Density,H=aa.Haze,O=aa.Offset,G=aa.Glare}end;aa.Density=0;aa.Haze=0;aa.Glare=0 end end;local function ab()if a8 then return end;a8={FogEnd=b.Lighting.FogEnd,FogStart=b.Lighting.FogStart,FogColor=b.Lighting.FogColor,Atmo={}}b.Lighting.FogEnd,b.Lighting.FogStart=1e10,1e10;for x,J in ipairs(b.Lighting:GetDescendants())do a9(J)end;a7=k(b.Lighting.DescendantAdded:Connect(a9))end;local function ac()if not a8 then return end;if a7 then a7:Disconnect()a7=nil end;b.Lighting.FogEnd,b.Lighting.FogStart,b.Lighting.FogColor=a8.FogEnd,a8.FogStart,a8.FogColor;for x,J in ipairs(b.Lighting:GetDescendants())do if J:GetAttribute("NFWasEnabled")then J:SetAttribute("NFWasEnabled",nil)if J.Enabled~=nil then J.Enabled=true end end end;for ad,ae in pairs(a8.Atmo)do if ad and ad.Parent then ad.Density,ad.Haze,ad.Offset,ad.Glare=ae.D,ae.H,ae.O,ae.G end end;a8=nil end;g.NoFog:OnChanged(function()if g.NoFog.Value then ab()else ac()end end)end;if i.Visuals.Xray then a5:AddToggle("XRay",{Text="X-Ray",Default=false,Tooltip="See through structures"})local function af(ag)for x,a3 in ipairs(b.Workspace:GetDescendants())do if a3:IsA("BasePart")then if not a3.Parent:FindFirstChildOfClass("Humanoid")and not(a3.Parent.Parent and a3.Parent.Parent:FindFirstChildOfClass("Humanoid"))then a3.LocalTransparencyModifier=ag and 0.5 or 0 end end end end;g.XRay:OnChanged(function()af(g.XRay.Value)end)end;if i.Visuals.Fullbright.Enabled then a5:AddToggle("Fullbright",{Text="Fullbright",Default=false})if i.Visuals.Fullbright.Brightness then a5:AddSlider("Fullbright_Brightness",{Text="Brightness",Default=i.Visuals.Fullbright.Brightness.Default or 1,Min=i.Visuals.Fullbright.Brightness.Min or 0.01,Max=i.Visuals.Fullbright.Brightness.Max or 5,Rounding=3})end;local ah,ai;local function aj()if ah then return end;ai=ai or{B=b.Lighting.Brightness,GS=b.Lighting.GlobalShadows,A=b.Lighting.Ambient}ah=k(b.RunService.RenderStepped:Connect(function()b.Lighting.Brightness=f.Fullbright_Brightness.Value;b.Lighting.GlobalShadows=false;b.Lighting.Ambient=Color3.new(1,1,1)end))end;local function ak()if ah then ah:Disconnect()ah=nil end;if ai then b.Lighting.Brightness=ai.B;b.Lighting.GlobalShadows=ai.GS;b.Lighting.Ambient=ai.A;ai=nil end end;g.Fullbright:OnChanged(function()if g.Fullbright.Value then aj()else ak()end end)end;if i.Visuals.FOV.Enabled then a5:AddSlider("CameraFOV",{Text="Camera FOV",Default=i.Visuals.FOV.Default or 70,Min=i.Visuals.FOV.Default or 40,Max=i.Visuals.FOV.Default or 120,Rounding=0})local function al()if d.camera then d.camera.FieldOfView=f.CameraFOV.Value end end;f.CameraFOV:OnChanged(al)al()end;if i.Visuals.Freecam.Enabled then a5:AddToggle("FreecamEnabled",{Text="Freecam",Default=false}):AddKeyPicker("FreecamKey",{Default=nil,SyncToggleState=true,Mode="Toggle",Text="Freecam Key"})if i.Visuals.Freecam.Sensitivity.Enabled then a5:AddSlider("FreecamSensitivity",{Text="Freecam Sensitivity",Default=i.Visuals.Freecam.Sensitivity.Default or 1,Min=i.Visuals.Freecam.Sensitivity.Default or 0.1,Max=i.Visuals.Freecam.Sensitivity.Default or 3,Rounding=2,Tooltip="Scales look + movement speed"})end;local am=b.Workspace.CurrentCamera;k(b.Workspace:GetPropertyChangedSignal("CurrentCamera"):Connect(function()am=b.Workspace.CurrentCamera end))local an,ao,ap,aq,ar,as,at,au=math.pi,math.exp,math.rad,math.sqrt,math.tan,math.abs,math.clamp,math.sign;local av=ap(90)local aw={}aw.__index=aw;function aw.new(ax,_)return setmetatable({f=ax,p=_,v=_*0},aw)end;function aw:Update(ay,az)local aA=self.f*2*an;local aB,aC=self.p,self.v;local aD=az-aB;local aE=ao(-aA*ay)local aF=az+(aC*ay-aD*(aA*ay+1))*aE;local aG=(aA*ay*(aD*aA-aC)+aC)*aE;self.p,self.v=aF,aG;return aF end;function aw:Reset(_)self.p=_;self.v=_*0 end;local aH=aw.new(1.5,Vector3.new())local aI=aw.new(1.0,Vector2.new())local aJ=aw.new(4.0,0)local aK,aL,aM=Vector3.new(),Vector2.new(),70;local aN=1;local aO={KB="CerbFC_Keyboard",MousePan="CerbFC_MousePan",Wheel="CerbFC_MouseWheel",GPBtn="CerbFC_GPBtn",GPTrig="CerbFC_GPTrig",GPThumb="CerbFC_GPThumb",TouchPan="CerbFC_TouchPan",Pinch="CerbFC_Pinch"}local aP={ButtonX=0,ButtonY=0,ButtonL2=0,ButtonR2=0,Thumbstick1=Vector2.new(),Thumbstick2=Vector2.new()}local aQ={W=0,A=0,S=0,D=0,E=0,Q=0,U=0,H=0,J=0,K=0,I=0,Y=0,Up=0,Down=0}local aR={Delta=Vector2.new(),MouseWheel=0}local aS={PanDelta=Vector2.new(),VerticalPanDelta=Vector2.new(),PinchDelta=1.0,ActiveTouches={}}local function aT(aU)local aV,aW=2.0,0.15;local function aX(a3)return(ao(aV*a3)-1)/(ao(aV)-1)end;local function aY(a3)return aX((a3-aW)/(1-aW))end;return au(aU)*at(aY(as(aU)),0,1)end;local function aZ()b.ContextActionService:BindActionAtPriority(aO.KB,function(x,a_,b0)aQ[b0.KeyCode.Name]=a_==Enum.UserInputState.Begin and 1 or 0;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.W,Enum.KeyCode.U,Enum.KeyCode.A,Enum.KeyCode.H,Enum.KeyCode.S,Enum.KeyCode.J,Enum.KeyCode.D,Enum.KeyCode.K,Enum.KeyCode.E,Enum.KeyCode.I,Enum.KeyCode.Q,Enum.KeyCode.Y,Enum.KeyCode.Up,Enum.KeyCode.Down)b.ContextActionService:BindActionAtPriority(aO.MousePan,function(x,x,b0)local J=b0.Delta;aR.Delta=Vector2.new(-J.y,-J.x)return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.MouseMovement)b.ContextActionService:BindActionAtPriority(aO.Wheel,function(x,x,b0)aR[b0.UserInputType.Name]=-b0.Position.z;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.MouseWheel)b.ContextActionService:BindActionAtPriority(aO.TouchPan,function(x,a_,b0)if a_==Enum.UserInputState.Begin then aS.ActiveTouches[b0.UserInputType]=true elseif a_==Enum.UserInputState.End then aS.ActiveTouches[b0.UserInputType]=nil elseif a_==Enum.UserInputState.Change then local b1=0;for x in pairs(aS.ActiveTouches)do b1=b1+1 end;if b1==1 then local J=b0.Delta;aS.PanDelta=aS.PanDelta+Vector2.new(-J.y,-J.x)elseif b1>=2 then local J=b0.Delta;aS.VerticalPanDelta=aS.VerticalPanDelta+J end end;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.Touch)b.ContextActionService:BindActionAtPriority(aO.Pinch,function(x,a_,b0)if a_==Enum.UserInputState.Change then aS.PinchDelta=b0.Scale end;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.Pinch)b.ContextActionService:BindActionAtPriority(aO.GPBtn,function(x,a_,b0)aP[b0.KeyCode.Name]=a_==Enum.UserInputState.Begin and 1 or 0;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.ButtonX,Enum.KeyCode.ButtonY)b.ContextActionService:BindActionAtPriority(aO.GPTrig,function(x,x,b0)aP[b0.KeyCode.Name]=b0.Position.z;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.ButtonR2,Enum.KeyCode.ButtonL2)b.ContextActionService:BindActionAtPriority(aO.GPThumb,function(x,x,b0)aP[b0.KeyCode.Name]=b0.Position;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.Thumbstick1,Enum.KeyCode.Thumbstick2)end;local function b2()aN=1;for b3 in pairs(aP)do aP[b3]=typeof(aP[b3])=="Vector2"and Vector2.new()or 0 end;for b3 in pairs(aQ)do aQ[b3]=0 end;aR.Delta=Vector2.new()aR.MouseWheel=0;aS.PanDelta=Vector2.new()aS.VerticalPanDelta=Vector2.new()aS.PinchDelta=1.0;table.clear(aS.ActiveTouches)for x,b4 in pairs(aO)do b.ContextActionService:UnbindAction(b4)end end;local b5={}local function b6()local b7=d.player:FindFirstChildOfClass("PlayerGui")b5.screens={}if b7 then for x,b8 in ipairs(b7:GetChildren())do if b8:IsA("ScreenGui")and b8.Enabled and b8.Name~="TouchGui"and b8.Name~="DynamicThumbstick"then b5.screens[#b5.screens+1]=b8;b8.Enabled=false end end end end;local function b9()if b5.screens then for x,b8 in ipairs(b5.screens)do if b8.Parent then b8.Enabled=true end end end;b5={}end;local ba,bb,bc;local function bd()ba=d.humanoid;if ba and ba.SetStateEnabled then bb=ba:GetStateEnabled(Enum.HumanoidStateType.Jumping)ba:SetStateEnabled(Enum.HumanoidStateType.Jumping,false)end;if b.UserInputService and b.UserInputService.JumpRequest then bc=k(b.UserInputService.JumpRequest:Connect(function()if ba then ba.Jump=false end end))end end;local function be()if bc then bc:Disconnect()bc=nil end;if ba and ba.SetStateEnabled then ba:SetStateEnabled(Enum.HumanoidStateType.Jumping,bb~=false)end;ba=nil;bb=nil end;local function bf(ay,bg)aN=at(aN+ay*(aQ.Up-aQ.Down)*0.75,0.01,4)local bh=Vector3.new(aT(aP.Thumbstick1.X),aT(aP.ButtonR2)-aT(aP.ButtonL2),aT(-aP.Thumbstick1.Y))local b3=Vector3.new(aQ.D-aQ.A+aQ.K-aQ.H,aQ.E-aQ.Q+aQ.I-aQ.Y-aS.VerticalPanDelta.Y*0.1,aQ.S-aQ.W+aQ.J-aQ.U)aS.VerticalPanDelta=Vector2.new()local bi=b.UserInputService:IsKeyDown(Enum.KeyCode.LeftShift)or b.UserInputService:IsKeyDown(Enum.KeyCode.RightShift)return(bh+b3)*64*aN*(bi and 0.25 or 1)*bg end;local function bj(ay,bg)local bk=Vector2.new(aT(aP.Thumbstick2.Y),aT(-aP.Thumbstick2.X))*an/8;local bl=(aR.Delta+aS.PanDelta)*an/64;aR.Delta=Vector2.new()aS.PanDelta=Vector2.new()return(bk+bl)*8*bg end;local function bm()local bk=(aP.ButtonX-aP.ButtonY)*0.25;local bn=aR.MouseWheel*1.0;local bo=(aS.PinchDelta-1.0)*-5.0;aR.MouseWheel=0;aS.PinchDelta=1.0;return bk+bn+bo end;local bp=false;local function bq(ay)local bg=f.FreecamSensitivity.Value or 1;local br=aH:Update(ay,bf(ay,bg))local bs=aI:Update(ay,bj(ay,bg))local bt=aJ:Update(ay,bm())local bu=aq(ar(ap(70/2))/ar(ap(aM/2)))aM=at(aM+bt*300*ay/bu,1,120)aL=aL+bs*ay/bu;aL=Vector2.new(at(aL.X,-av,av),aL.Y%(2*an))local bv=CFrame.new(aK)*CFrame.fromOrientation(aL.X,aL.Y,0)*CFrame.new(br*ay)aK=bv.Position;am.CFrame=bv;am.Focus=bv;am.FieldOfView=aM end;local function bw()if bp then return end;local bv=am.CFrame;aL=Vector2.new(bv:toEulerAnglesYXZ())aK=bv.Position;aM=am.FieldOfView;aH:Reset(Vector3.new())aI:Reset(Vector2.new())aJ:Reset(0)b6()bd()am.CameraType=Enum.CameraType.Scriptable;b.UserInputService.MouseIconEnabled=false;b.UserInputService.MouseBehavior=Enum.MouseBehavior.LockCenter;aZ()b.RunService:BindToRenderStep("CerbFreecam",Enum.RenderPriority.Camera.Value,bq)bp=true end;local function bx()if not bp then return end;b.RunService:UnbindFromRenderStep("CerbFreecam")b2()be()am.CameraType=Enum.CameraType.Custom;b.UserInputService.MouseBehavior=Enum.MouseBehavior.Default;b.UserInputService.MouseIconEnabled=true;aR.Delta=Vector2.new()aR.MouseWheel=0;b9()bp=false end;g.FreecamEnabled:OnChanged(function()if g.FreecamEnabled.Value then e:Notify("Freecam enabled.",2)bw()else e:Notify("Freecam disabled.",2)bx()end end)end end;if h then h:Register(function()for I=#j,1,-1 do local by=j[I]j[I]=nil;pcall(function()if by and by.Disconnect then by:Disconnect()end end)end end)end;return{}end
