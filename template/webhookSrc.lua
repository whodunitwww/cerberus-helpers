return function(a)local b=a.Services;local c=a.Tabs;local d=a.References;local e=a.Options;local f=a.Toggles;local g=a.SendDiscordWebhook;local h=a.Unloader;local i=a.WebhookConfig or{}if i.Enabled~=true then return{Emit=function()end,RegisterEvent=function()end}end;local j={}local function k(l)if l then j[#j+1]=l end end;local function m(n)return i.Events and i.Events[n]==true end;local function o()local p={}for n in pairs(i.Events or{})do p[#p+1]=n end;table.sort(p)return p end;local function q()local r={}local s=o()for t,n in ipairs(s)do if i.Events and i.Events[n]then r[#r+1]=n end end;return r end;local function u(v)i.Events=i.Events or{}for n in pairs(i.Events)do i.Events[n]=false end;if type(v)=="string"then i.Events[v]=true;return end;if type(v)~="table"then return end;local w=false;for n,x in pairs(v)do if type(x)=="boolean"then w=true;if x then i.Events[n]=true end end end;if w then return end;for t,n in ipairs(v)do if type(n)=="string"then i.Events[n]=true end end end;local y=c.Home:AddLeftGroupbox("Webhook","send")y:AddInput("WebhookURL",{Text="Webhook URL",Placeholder="https://discord.com/api/webhooks/...",ClearTextOnFocus=false})y:AddLabel("Embed Color"):AddColorPicker("WebhookColor",{Default=Color3.fromRGB(54,150,45)})y:AddToggle("WebhookAnon",{Text="Anonymize User Data",Default=false})y:AddDropdown("WebhookEvents",{Text="Events",Values=o(),Default=q(),Multi=true,Callback=function(z)u(z)end})local function A(B,C)local D=e.WebhookURL and e.WebhookURL.Value;if type(D)~="string"or not D:find("discord.com/api/webhooks",1,true)then return end;local E=e.WebhookColor and e.WebhookColor.Value;if typeof(E)~="Color3"then E=Color3.fromRGB(54,150,45)end;local F=math.floor(E.R*255)*65536+math.floor(E.G*255)*256+math.floor(E.B*255)local G=f.WebhookAnon and f.WebhookAnon.Value==true;task.spawn(function()pcall(g,D,B,C,"Cerberus",F,nil,G)end)end;local H={}function H.Emit(I,B,C)if not m(I)then return end;A(B,C)end;function H.RegisterEvent(I)if type(I)~="string"then return end;i.Events=i.Events or{}if i.Events[I]==nil then i.Events[I]=false end;if e.WebhookEvents and e.WebhookEvents.SetValues then e.WebhookEvents:SetValues(o())end end;do local function J(K)k(K.Chatted:Connect(function(L)H.Emit("Chat","Chat Message",string.format("%s: %s",K.Name,tostring(L)))end))end;for t,K in ipairs(b.Players:GetPlayers())do J(K)end;k(b.Players.PlayerAdded:Connect(J))end;do k(b.Players.PlayerAdded:Connect(function(K)if K~=d.player then H.Emit("PlayerJoinLeave","Player Joined",K.Name)end end))k(b.Players.PlayerRemoving:Connect(function(K)if K~=d.player then H.Emit("PlayerJoinLeave","Player Left",K.Name)end end))end;do local M={}k(b.RunService.Heartbeat:Connect(function()if not m("InventoryChange")then return end;local N=d.player:FindFirstChild("Backpack")if not N then return end;for t,O in ipairs(N:GetChildren())do local n=O.Name;if not M[n]then M[n]=true;H.Emit("InventoryChange","Item Added",n)end end end))end;if h then h:Register(function()for P=#j,1,-1 do local E=j[P]j[P]=nil;pcall(function()if E and E.Disconnect then E:Disconnect()end end)end end)end;return H end
